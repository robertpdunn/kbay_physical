---
title: "fix_sediments"
author: "Ouida"
date: "15 March 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
Set up the packages
```{r}
## install individual packages
# install.packages('readr')
# install.packages('dplyr')
# install.packages('tidyr')
# install.packages('janitor')

## load individual packages
library(readr)
library(dplyr)
library(tidyr)
library(janitor)
```
Load the data
Sediment dataset accessed through the Zenodo repository. Data citation:
Ritson-Williams, R., & Gates, R. D. (2016). Kaneohe Bay Sediment Data 2015 [Data set]. Zenodo. http://doi.org/10.5281/zenodo.61137

```{r}
sediments_raw <- read.csv("https://zenodo.org/record/61137/files/Kbay_sediment_2015.csv")
head(sediments_raw)
```

Make a column for reef and fix the dates
```{r}

## cleaned headers and reef record names
sediments <- clean_names(sediments_raw)
sediments <- sediments %>%
  mutate(reef = gsub("reef", "reef_", site)) %>%
  mutate(reef = gsub("HIMB", "reef_himb", reef))
## select and order columns
sediments <- sediments %>%
  select(.data$reef, .data$date, .data$sediment_grams_per_day)
head(sediments)
## assign dates to first of each month to align with other streamlined datasets
# sediments <- sediments %>%  
#   mutate("year_month"=floor_date(as.Date(sediments$date,'%m/%d/%y'),unit="month"))

```
Find means for each month
```{r}
sediments_monthly <- sediments %>% 
  group_by(reef, year_month) %>%
  summarise(sediment_mean_grams_per_day=mean(sediment_grams_per_day)) %>% 
  ungroup() 
```
save the file
```{r}
write_csv(sediments_monthly,"data_tidy/sediments_monthly")
```
